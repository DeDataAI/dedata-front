"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7535],{57266:function(e,t,n){var a=n(57437),s=n(26735),r=n(27539),i=n(75893),o=n(42007),l=n(59733),c=n(2265),u=n(36922),d=n(15670);let{TextArea:m}=i.default;t.Z=function(e){let{roleStatus:t,applyStatus:n,languageStatus:i,onSaveChange:m,onExpiredTimeChange:p,type:y}=e,[f,h]=(0,c.useState)({content:"",makeList:[]}),[x,g]=(0,c.useState)(null),{address:b,isConnected:v}=(0,s.m)(),{signMessageAsync:w}=(0,r.Q)();async function S(){if(!x){o.ZP.info("Please finish current case");return}j()}async function j(){let e=await w({message:"makeId: ".concat(x)}),{code:t,msg:n}=await (0,u.UJ)({makeId:x,address:b,signature:e});t===d.Gh?(o.ZP.info("Save successfully"),setTimeout(()=>{m()},2e3)):o.ZP.error(n)}if((0,c.useEffect)(()=>{async function e(){let{code:e,data:t,msg:n}=await (0,u.Ls)(b,i,"alpha"===y?1:2);if(e===d.Gh){let{content:e,expiredTime:n}=t;h({...t,content:e.replace("\n","<br>")||""});let a=(n-Math.floor(Date.now()))/1e3;if(a<0)return;p({minutes:Math.floor(a/60),seconds:Math.floor(a%60)})}else o.ZP.error(n),setTimeout(()=>{m()},2e3)}b&&2===t&&n&&e()},[t,b,n,i,m,p,y]),2===t&&n){let e=(0,a.jsx)(l.ZP.Group,{onChange:e=>{let{target:{value:t}}=e;g(t)},children:null==f?void 0:f.makeList.map((e,t)=>(0,a.jsx)("div",{className:"bg-[#F5F7FA] px-[0.2rem] py-[0.08rem] rounded-[0.16rem] mb-[0.1rem]",children:(0,a.jsx)(l.ZP,{value:e.id,children:e.content})},t))});return(0,a.jsx)("div",{className:"h-[calc(100%-0.4rem)] pt-[0.16rem]",children:(0,a.jsxs)("div",{className:"flex flex-col h-full overflow-y-auto",children:[(0,a.jsx)("span",{className:"text-[#000] text-[0.14rem] font-bold mb-[0.14rem]",children:"Original Article"}),(0,a.jsx)("div",{className:"text-[#000] text-[0.14rem] leading-[0.22rem] bg-[#F5F7FA] px-[0.24rem] py-[0.16rem] rounded-[0.16rem]",dangerouslySetInnerHTML:{__html:null==f?void 0:f.content}}),(0,a.jsxs)("span",{className:"text-[#000] text-[0.14rem] font-bold mt-[0.24rem] mb-[0.14rem]",children:["Abstract",(0,a.jsx)("span",{className:"text-[#999] text-[0.12rem] font-bold mt-[0.24rem] mb-[0.14rem]",children:"（Choose the best summary of the news）"})]}),e,(0,a.jsx)("div",{className:"w-[2rem] h-[0.48rem] bg-[#3A54DF] text-[#fff] rounded-[0.16rem] leading-[0.48rem] text-center font-bold text-[0.18rem] mt-[0.08rem] cursor-pointer",onClick:S,children:"Save"})]})})}return null}},80246:function(e,t,n){n.d(t,{Z:function(){return u}});var a=n(57437),s=n(42007),r=n(22272),i=n(15670),o=n(2265),l=n(26735),c=function(e){let{hours:t=0,minutes:n=0,seconds:s=0,resetTime:r=function(){}}=e,[i,l]=(0,o.useState)(!1),[c,u]=(0,o.useState)(!1),[d,m]=(0,o.useState)({hours:t,minutes:n,seconds:s}),p=()=>{i||c||(0===d.hours&&0===d.minutes&&0===d.seconds?u(!0):0===d.minutes&&0===d.seconds?m({hours:d.hours-1,minutes:59,seconds:59}):0===d.seconds?m({hours:d.hours,minutes:d.minutes-1,seconds:59}):m({hours:d.hours,minutes:d.minutes,seconds:d.seconds-1}))};return(0,o.useEffect)(()=>{m({hours:0,minutes:n,seconds:s})},[n,s]),(0,o.useEffect)(()=>{let e=setInterval(()=>p(),1e3);return 0===d.minutes&&0===d.seconds&&r(),()=>clearInterval(e)}),(0,a.jsx)("div",{className:"text-[14px] text-[#000] mx-[0.1rem] w-[0.5rem]",children:"".concat(d.minutes.toString().padStart(2,"0"),":").concat(d.seconds.toString().padStart(2,"0"))})},u=function(e){let[t,n]=(0,o.useState)("en"),[u,d]=(0,o.useState)(1),[m,p]=(0,o.useState)(!1),[y,f]=(0,o.useState)(10),[h,x]=(0,o.useState)(0),[g,b]=(0,o.useState)(!0),{isConnected:v}=(0,l.m)();return(0,o.useEffect)(()=>{p(e.disabled),n(e.languageStatus),d(e.roleStatus),f(e.minutes),x(e.seconds),void 0!==e.showRoles&&null!==e.showRoles&&b(!!e.showRoles)},[e]),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-[0.16rem] font-bold text-[#000]",children:e.title}),(0,a.jsxs)("div",{className:"flex items-center h-[0.4rem]",children:[m&&(0,a.jsxs)("span",{className:"text-[0.14rem] text-[#333] ml-[0.1rem] mr-[0.3rem]",children:["Estimated point: ",1===u?10:1]}),m&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"text-[0.14rem] text-[#333] ml-[0.1rem]",children:"Expire Time: "}),(0,a.jsx)(c,{minutes:y,seconds:h,resetTime:function(){e.onApplyChange(!1)}})]}),(0,a.jsx)(r.Z,{value:t,style:{width:"1.5rem",height:"0.32rem"},onChange:function(t){n(t),e.onRoleAndLanguageChange({languageStatus:t,roleStatus:u})},options:i.a2,disabled:m}),g&&(0,a.jsx)("span",{className:"text-[0.14rem] text-[#333] ml-[0.1rem]",children:"Role:"}),g&&(0,a.jsx)(r.Z,{value:u,style:{width:"1.5rem",height:"0.32rem"},onChange:function(n){d(n),e.onRoleAndLanguageChange({languageStatus:t,roleStatus:n})},options:i.K$,disabled:m}),(0,a.jsx)("div",{className:"bg-[#3A54DF] h-[0.32rem] leading-[0.32rem] text-center w-[1.28rem] text-[#fff] text-[0.14rem] cursor-pointer rounded-[0.16rem] ml-[0.1rem]",onClick:function(){if(!v){s.ZP.info("Please connect wallet first");return}if(m){s.ZP.info("Please finish current case");return}e.onApplyChange(!0)},children:"+ Apply Case"})]})]})}},86377:function(e,t,n){n.d(t,{Z:function(){return h}});var a=n(57437),s=n(42007),r=n(26735),i=n(27539),o=n(60479),l=n(58729),c=n(2265),u=n(36922),d=n(15670),m=n(53507);let p="0xFF45d2e4E35DdAdC12f6c5a853e9c4BA499e5538",y=[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"ECDSAInvalidSignature",type:"error"},{inputs:[{internalType:"uint256",name:"length",type:"uint256"}],name:"ECDSAInvalidSignatureLength",type:"error"},{inputs:[{internalType:"bytes32",name:"s",type:"bytes32"}],name:"ECDSAInvalidSignatureS",type:"error"},{inputs:[{internalType:"address",name:"account",type:"address"},{internalType:"uint256",name:"currentNonce",type:"uint256"}],name:"InvalidAccountNonce",type:"error"},{inputs:[],name:"InvalidInitialization",type:"error"},{inputs:[],name:"NotInitializing",type:"error"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"OwnableInvalidOwner",type:"error"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"OwnableUnauthorizedAccount",type:"error"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint64",name:"version",type:"uint64"}],name:"Initialized",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!1,internalType:"uint256",name:"nonce",type:"uint256"},{indexed:!1,internalType:"uint256",name:"points",type:"uint256"},{indexed:!1,internalType:"uint256",name:"tasks",type:"uint256"}],name:"PointsAdded",type:"event"},{inputs:[{internalType:"address",name:"user",type:"address"},{components:[{internalType:"uint256",name:"nonce",type:"uint256"},{internalType:"uint256",name:"points",type:"uint256"},{internalType:"uint256",name:"tasks",type:"uint256"}],internalType:"struct PointHelper.Point",name:"point",type:"tuple"},{internalType:"bytes",name:"oracleSignature",type:"bytes"}],name:"addPoints",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"},{components:[{internalType:"uint256",name:"nonce",type:"uint256"},{internalType:"uint256",name:"points",type:"uint256"},{internalType:"uint256",name:"tasks",type:"uint256"}],internalType:"struct PointHelper.Point",name:"point",type:"tuple"}],name:"getMessageHash",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"address",name:"_owner",type:"address"},{internalType:"address",name:"_oracle",type:"address"}],name:"initialize",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"nonces",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"oracle",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_oracle",type:"address"}],name:"setOracle",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"userPoints",outputs:[{internalType:"uint256",name:"points",type:"uint256"},{internalType:"uint256",name:"tasks",type:"uint256"}],stateMutability:"view",type:"function"}];var f=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";arguments.length>1&&void 0!==arguments[1]&&arguments[1];let[t,n]=(0,c.useState)(0),{refetch:a}=(0,m.u)({functionName:"nonces",address:p,abi:y,args:[e]}),s=(0,c.useCallback)(async()=>{let{data:e}=await a();console.log("-------->nonce",e),n(e)},[a]);return(0,c.useEffect)(()=>{s()},[s]),{nonce:t,getNonce:s}},h=function(e){let{applyStatus:t}=e,[n,m]=(0,c.useState)({totalCompletedCases:0,onchainCases:0,totalPoints:"0",onchainPoints:"0"}),[h,x]=(0,c.useState)(0),{address:g,isConnected:b}=(0,r.m)(),{signMessageAsync:v}=(0,i.Q)(),{data:w,isPending:S,isSuccess:j,writeContractAsync:N}=(0,o.S)(),{nonce:T,getNonce:C}=f(g,5e3),{isLoading:P,isSuccess:A,error:k}=(0,l.A)({hash:w,confirmations:7}),F=(0,c.useCallback)(async()=>{let e=await (0,u.dS)(g);console.log("------>loadData",e),m(e.data)},[g]),E=(0,c.useCallback)(async()=>{let{code:e,msg:t,data:n}=await (0,u.pS)(g);if(e!==d.Gh||!n.length)return x(0),{points:[],oracleSignature:""};{let e=n.map(e=>{let{points:t,cases:n}=e;return{tasks:n,nonce:T,points:BigInt(10*Number(t))*BigInt(1e17)}}),t=n[0].oracleSignature;return x(3),{points:e,oracleSignature:t}}},[T,g]);async function I(){if(1===h)return;let e=Number(n.totalPoints)-Number(n.onchainPoints),t=n.totalCompletedCases-n.onchainCases,a=await E();if(e<=0&&t<=0&&!a.oracleSignature)return;await C();let s="",r=[];if(a.oracleSignature)s=a.oracleSignature,r=a.points;else{let e=await M();s=e.oracleSignature,r=[{tasks:e.cases,nonce:T,points:BigInt(10*Number(e.points))*BigInt(1e17)}]}let i={functionName:"addPoints",address:p,abi:y,args:[g,...r,s]};await N(i)}async function M(){let e="nonce: ".concat(T),t=await v({message:e}),{code:n,msg:a,data:r}=await (0,u.AJ)({nonce:"".concat(T),address:g,signature:t});if(n===d.Gh)return r;throw s.ZP.error(a),Error(a)}return(0,c.useEffect)(()=>{S&&console.log("Confirming...")},[S]),(0,c.useEffect)(()=>{P&&(console.log("Waiting for confirmation..."),x(1)),A&&(console.log("Transaction confirmed."),x(2),F()),k&&(console.log("Transaction failed:",k),x(3))},[P,A,F,k]),(0,c.useEffect)(()=>{g&&!t&&(F(),E())},[g,t,E,F]),(0,a.jsxs)("div",{className:"flex flex-col h-[1.18rem] w-full bg-[#fff] rounded-[0.16rem] mb-[0.16rem] px-[0.22rem] py-[0.16rem]",children:[(0,a.jsx)("span",{className:"text-[0.16rem] font-bold text-[#000] mb-[0.06rem] leading-[0.16rem]",children:"Dashboard"}),(0,a.jsxs)("div",{className:"flex justify-around items-start",children:[(0,a.jsxs)("div",{className:"flex flex-col justify-center items-center",children:[(0,a.jsx)("span",{className:"text-[0.16rem] text-[#000] leading-[0.24rem] h-[0.24rem]",children:g&&n?n.totalCompletedCases:"-"}),(0,a.jsx)("span",{className:"text-[0.14rem] text-[#999] leading-[0.14rem]",children:"Total Cases"})]}),(0,a.jsxs)("div",{className:"flex flex-col justify-center items-center",children:[(0,a.jsxs)("span",{className:"text-[0.16rem] text-[#000] leading-[0.24rem] h-[0.24rem]",children:[(0,a.jsxs)("span",{children:["Cases:\xa0\xa0",g&&n?n.totalCompletedCases-n.onchainCases:"-"]}),(0,a.jsxs)("span",{className:"ml-[0.4rem]",children:["Points:\xa0\xa0",g&&n?(Number(n.totalPoints)-Number(n.onchainPoints)).toFixed(1):"-"]})]}),(0,a.jsx)("span",{className:"text-[0.14rem] text-[#999] leading-[0.16rem]",children:"Pending Submits"}),(0,a.jsxs)("span",{className:"text-[0.14rem] leading-[0.24rem] bg-[#EFF7FF] mt-[0.06rem] h-[0.24rem] px-[0.1rem] text-[#3A54DF] rounded-[0.16rem] cursor-pointer",onClick:I,children:[(0===h||2===h)&&"Submit onChain",3===h&&"Retry",1===h&&"Pending"," >"]})]}),(0,a.jsxs)("div",{className:"flex flex-col justify-center items-center",children:[(0,a.jsx)("span",{className:"text-[0.16rem] text-[#000] leading-[0.24rem] h-[0.24rem]",children:g&&n?n.onchainCases:"-"}),(0,a.jsx)("span",{className:"text-[0.14rem] text-[#999] leading-[0.16rem]",children:"Total Cases onChain"})]}),(0,a.jsxs)("div",{className:"flex flex-col justify-center items-center",children:[(0,a.jsx)("span",{className:"text-[0.16rem] text-[#000] leading-[0.24rem] h-[0.24rem]",children:g&&n?Number(n.onchainPoints).toFixed(1):"-"}),(0,a.jsx)("span",{className:"text-[0.14rem] text-[#999] leading-[0.16rem]",children:"onChain Points"})]})]})]})}},10701:function(e,t,n){var a=n(57437),s=n(66648),r=n(2265),i=n(26735),o=n(42007);t.Z=function(e){let[t,n]=(0,r.useState)(!1),{isConnected:l}=(0,i.m)();return((0,r.useEffect)(()=>{n(e.applyStatus)},[e.applyStatus]),t)?null:(0,a.jsxs)("div",{className:"flex flex-1 flex-col justify-center items-center",children:[(0,a.jsx)("div",{className:"w-[1.6rem] h-[1.6rem]",children:(0,a.jsx)(s.default,{src:"/empty.png",alt:"logo",width:0,height:0,className:"w-full h-auto",priority:!0})}),(0,a.jsx)("span",{className:"text-[0.16rem] leading-[0.21rem] mb-[0.26rem] -mt-[0.2rem]",children:"Click to apply new cases"}),(0,a.jsx)("div",{className:"bg-[#3A54DF] h-[0.6rem] w-[2rem] text-[0.16rem] rounded-[0.16rem] text-[#fff] text-center leading-[0.6rem] cursor-pointer font-bold",onClick:function(){if(!l){o.ZP.info("Please connect wallet first");return}n(!0),e.onApplyChange(!0)},children:"+ Apply Case"})]})}},36922:function(e,t,n){async function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={...t,headers:{"Content-Type":"application/json",...t.headers}};try{let t=await fetch("".concat("https://api.dedata.io").concat(e),n);return await t.json()}catch(e){throw console.error("Fetch error:",e),e}}async function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return a("/v1/points/summary?address=".concat(e))}async function r(e){return a("/v1/points/onchain",{method:"POST",body:JSON.stringify(e)})}async function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return a("/v1/cases/pending-case?address=".concat(e,"&type=").concat(t))}async function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en";return a("/v1/cases/make-case?address=".concat(e),{headers:{lang:t}})}async function l(e){return a("/v1/cases/make-case",{method:"POST",body:JSON.stringify(e)})}async function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return a("/v1/cases/check-case?address=".concat(e,"&type=").concat(n),{headers:{lang:t}})}async function u(e){return a("/v1/cases/check-case",{method:"POST",body:JSON.stringify(e)})}async function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return a("/v1/points/pending-onchain-transactions?address=".concat(e))}n.d(t,{UJ:function(){return u},ej:function(){return l},Ls:function(){return c},gF:function(){return o},G4:function(){return i},pS:function(){return d},dS:function(){return s},AJ:function(){return r}})},15670:function(e,t,n){n.d(t,{Gh:function(){return a},K$:function(){return i},a2:function(){return r},dM:function(){return s}});let a="000000000",s=[{id:"Alpha",route:"/",title:"DeArticle(Alpha)"},{id:"Beta",route:"/beta",title:"DeArticle(Beta)"},{id:"others",route:"/others",title:"Others"}],r=[{label:"English",value:"en"},{label:"Chinese",value:"cn"}],i=[{label:"Maker",value:1},{label:"Checker",value:2}]}}]);